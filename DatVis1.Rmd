---
title: "Data Visualization Task 1"
author: 
- name: Alexander Jaenisch, Rafaela Neff, Parvin Shakibaei
  affiliation: Beuth University of Applied Science Berlin
date: "Summer Term 2018"
output: 
  html_document: 
    fig_caption: yes
    highlight: tango
    number_sections: yes
    theme: spacelab
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
library(knitr) #to set up options and use kable function
opts_chunk$set(echo = FALSE, cache=FALSE) #(echo = TRUE) would include all code
read_chunk('src/script.R')
```

```{r part1}
```
# Introduction

In this excersise we examin color measurements of prints of Douglas color cards. The intended colors for color card production were compared to thirteen large sheets, sampled from production. Each sample sheet contains 42 color cards also refered to as target.

The colors are represented in Lab color space.

The repository can be found on [Github](https://github.com/amidisturbing/datavis2018).

## Lab color space

Colors are mathematically described with three components in the Lab* color space:

- **L**: luminance
- **a**: color from green to magenta 
- **b**: color from blue to yellow

The difference between two colors can be descriped by the Δ E formular, which will be covered in the following section.

## Defining and interpreting Δ E

ΔE - (Delta E, dE) is the euclidean distance between their colorimetric coordinates.
It is a metric that encodes a numeric understanding how the human eye perceives color difference.
The word Delta defines a difference between two spots while E comes from the German Word *"Empfindung"*.

In this Analysis the E76 vaue was calculated which got his name from the year it was founded, which was 1976. 

The formular is

∆E76 = sqrt((∆L)^2 + (∆a)^2 + (∆b)^2)

where:

∆L = L1 − L2 - difference of luminance.

∆a = a1 − a2 - difference of values for coordinate a, ∆b = b1 − b2 - difference of values for coordinate b.

∆b = b1 − b2 - difference of values for coordinate b.

```{r}
perceptionTable <- matrix(NA, nrow = 5, ncol = 2, byrow = FALSE)
colnames(perceptionTable) <- c("ΔE value","Perception")
deltaE <- c("<= 1.0","1 - 2", "3 - 10", "11 - 49", "100")
perception <- c("Not perceptible by human eyes.", "Perceptible through close observation.
", "Perceptible at a glance.
", "Colors are more similar than opposite
", "Colors are exact opposite
")
for (i in 1:5) {
  perceptionTable[i,"ΔE value"] <- deltaE[i]
  perceptionTable[i,"Perception"] <- perception[i]
}
kable(perceptionTable, caption = "On a typical scale, the Delta E value will range from 0 to 100.")
```

# Results

To examine the color distance the colors of the sample color cards and their visibility the samples were compared to the data master
retrieved from the master color card data.

The steps are descriped in the next subsections.

## Calculating ΔE values

tranposes the matrix
creates a matrix by repeating the rows to fit the lab data 
create a matrx that contains the squared distance between the Lab values of master and lab


SpotErrorMatrix contains ΔE values for each spot (one row is one colour card)

## Data for visualization

count how many spots belong into each visibility group
visibility of color changes per card

find min's and max's ΔE values per target
get the lab values for each element of the index list

convert lab matrix to rgb matrix to plot

# Analysis

## How do colors behave relative to the print master?

It can be seen that the colors have the same relation to the print master. While it is evidently, that there is always one color with the smallest ΔE value regarding the print master, the biggest error almost always appears at the same color spot, too.

The distribution of the 

```{r fig.cap="Distribution of the ∆E values in the 5 visibility levels.", barplotVisLevel}
```
The mean Error relative to the print master is comparatively low, as the followng density plot is showing.

```{r fig.cap="The density of ΔE value shows the highest error between 3.5 and 4. It is compared to the master data and perceptible at glance.", densityMeanError}
```

## Is the behavior differential between targets?

One target is a sigle color card on one sample sheet. One sample can be seen as a big sheet containing 42 color cards. The behavior inbetween the targets is very similar, which is also shown in the relation to the print master discussed in the previouse section.
The mean ΔE value per target does not show a big range. In the density plot from the previouse section it can be seen that the error ranges from 3.6 to 4.2, which still is at glance.

The histogram shows the distribution of the targets regarding their  ΔE value to the Master Color Card.

```{r fig.cap="The mean ΔE value per target shows that the most target sheets show an error that is only perceptible at glance.", histMeanErrorPerTarget}
```

## Is the behavior differential between samples?

The mean error of one sample relativ to the print master falls almost in the same range as the mean Error per target, but is 0.3 higher at its smallest value. This is not perceptible for the human eye.

```{r fig.cap="The most samples show a ΔE value between 3.8 and 3.9 compared to the master.", histMeanErrorPerSample}
```


## Is the behavior differential between color spots?

```{r fig.cap="The comparisson between the intended color taken from the Master Color Card and the color spot with the highest Error is shown below.", compareWorseBestDelta}
```
## Is quality possibly related to the intended color?

Since the minimal ΔE values, as well as the maximum ΔE values always appear on the same color spot, the Error seems to be very much related to the intended color. 

## More Plots 
```{r fig.cap="l1", rgbForVisLevelOne}
```

```{r fig.cap="", rgbForVisLevelTwo}
```

```{r fig.cap="", rgbForVisLevelThree}
```

```{r fig.cap="", rgbForVisLevelFour}
```